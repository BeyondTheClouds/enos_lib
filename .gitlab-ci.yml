stages:
- package
- deploy


#### Entering th release zone
package:
    stage: package
    only: 
        - tags
    image: python
    script:
    - python setup.py bdist_wheel --universal
    artifacts:
        paths:
        - dist/

publish:
    stage: deploy
    image: python
    dependencies:
    - package
    script:
        - pip install twine
        # credentials are set in the env by gitlab
        - twine upload dist/* --repository-url https://test.pypi.org 